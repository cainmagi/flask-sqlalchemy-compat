---
id: clone_method
title: clone_method
sidebar_label: clone_method
slug: /apis/utilities/clone_method
description: 装饰器，透过克隆另一个方法的签名，来修改某方法的静态注解。
---

import Tabs from "@theme/Tabs";
import TabItem from "@theme/TabItem";

import vsiCheckIcon from "@iconify-icons/codicon/check";

import InlineIcon from "@site/src/components/InlineIcon";
import APITopBar, {IconObjType} from "@site/src/components/APITopBar";

<APITopBar
  type="func"
  isPrivate={true}
  isDecorator={true}
  source="utilities.clone_method"
/>

```python
decorator: Callable[
  [Callable[Concatenate[S, P], T]],
  Callable[Concatenate[S, P], T]
] = clone_method[**P, S, T](
    func_o: Callable[Concatenate[P], Any],
)

class Example:
    @clone_method(func_o)
    def func(self, val1, val2, ...): ...
```

装饰器，透过克隆另一个方法的签名，来修改某方法的静态注解。

该装饰器应当用于克隆某个普通的绑定方法。它不适用于类方法、静态方法、或普通的函数。

:::note

须知，该装饰器不会修改被装饰方法签名中的返回值。

:::

:::note

须知，该装饰器不会修改被装饰方法在运行时的行为。

:::

## 参数 {#arguments}

### 输入 {#requires}

|   参数   |      类型      |               必选                | <center>说明</center>                                                                                                    |
| :------: | :------------: | :-------------------------------: | ------------------------------------------------------------------------------------------------------------------------ |
| `func_o` | `(**P) -> Any` | <InlineIcon icon={vsiCheckIcon}/> | <p>用来提供被克隆的签名的原函数。其签名应当与一个已经绑定后的方法格式相同。</p><p>但须知该函数自身并非一个绑定方法。</p> |

### 输出 {#returns}

|    参数     |                       类型                       | <center>说明</center>                                                                                                                                                          |
| :---------: | :----------------------------------------------: | :----------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `decorator` | `((self: S, **P) -> T) -> ((self: S, **P) -> T)` | <p>一个包装函数。该函数直接返回被包装的函数。但所返回的被包装函数，其签名会与参数`func_o`一致。</p><p>签名的输入参数部分、拷贝自`func_o`，而输出值仍然由被包装的方法决定。</p> |

## 范例 {#examples}

### <IconObjType type="term"/> 将函数的签名克隆到某个方法 {#-clone-the-signature-of-a-function-to-a-method}

<Tabs
  defaultValue="codes"
  values={[
    { label: '代码', value: 'codes', },
    { label: '结果', value: 'results', },
  ]
}>

<TabItem value="codes">

```python title="clone_signature_to_method.py" showLineNumbers
from typing import reveal_type
import inspect
import flask_sqlalchemy_compat as fsc


def test_func(val1: int, val2: str) -> float: ...


class Example:
    @fsc.utilities.clone_method(test_func)
    def modified_method(self, *args, **kwargs) -> str:
        return "不是float！"


if __name__ == "__main__":
    reveal_type(Example().modified_method)
    print(inspect.signature(Example().modified_method))
    print(Example().modified_method(1, "2"))
```

</TabItem>

<TabItem value="results">

```python
Runtime type is 'method'
(val1: int, val2: str) -> str
不是float！
```

</TabItem>

</Tabs>
